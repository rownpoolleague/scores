<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Scoresheet</title>
<style>
body{font-family:Arial,sans-serif}
.row{display:flex;justify-content:center;gap:40px;margin-top:40px}
.block{text-align:left}
.roster-box{margin-top:10px;padding:8px 10px;border:1px solid #000;min-width:220px;min-height:80px;font-size:14px}
label{font-weight:bold}
.playerName{cursor:pointer;padding:2px 0}
.playerName:hover{background:#e0e0e0}
h3{margin:0 0 8px 0}
</style>
</head>

<body>

<div class="row">
  <div class="block">
    <label>Team</label><br>
    <select id="team">
      <option value="">-- Select --</option>
      <option>Halfway Crooks</option>
      <option>Haters Welcome</option>
      <option>Lynn's Amigos</option>
      <option>Rackless Behavior</option>
      <option>Dirty Ballers</option>
      <option>8 on Break</option>
      <option>Five Amigos</option>
      <option>Frank's Pizza</option>
      <option>Killer Instinct</option>
      <option>Pete's Bunch</option>
    </select>
    <div id="teamRoster" class="roster-box"></div>
  </div>

  <div class="block">
    <label>Opponent</label><br>
    <select id="opponent">
      <option value="">-- Select --</option>
      <option>Halfway Crooks</option>
      <option>Haters Welcome</option>
      <option>Lynn's Amigos</option>
      <option>Rackless Behavior</option>
      <option>Dirty Ballers</option>
      <option>8 on Break</option>
      <option>Five Amigos</option>
      <option>Frank's Pizza</option>
      <option>Killer Instinct</option>
      <option>Pete's Bunch</option>
    </select>
    <div id="opponentRoster" class="roster-box"></div>
  </div>
</div>

<div style="display:flex;justify-content:center;gap:40px;margin-top:30px">
  <div class="block">
    <label>Lag Winner</label><br>
    <input id="lagWinner" readonly>
  </div>
  <div class="block">
    <label>Lag Loser</label><br>
    <input id="lagLoser" readonly>
  </div>
</div>

<div style="text-align:center;margin-top:20px">
  <label>Innings</label><br>
  <input type="number" id="matchInnings">
</div>

<div style="display:flex;justify-content:center;gap:60px;margin-top:30px">
  <div class="block">
    <h3>Player A</h3>
    HC <input id="pA_hc"><br>
    Wins <input id="pA_wins"><br>
    Losses <input id="pA_losses"><br>
    Safeties <input id="pA_safeties"><br>
    8OB <input id="pA_e8"><br>
    B&R <input id="pA_br">
  </div>

  <div class="block">
    <h3>Player B</h3>
    HC <input id="pB_hc"><br>
    Wins <input id="pB_wins"><br>
    Losses <input id="pB_losses"><br>
    Safeties <input id="pB_safeties"><br>
    8OB <input id="pB_e8"><br>
    B&R <input id="pB_br">
  </div>
</div>

<div style="text-align:center;margin-top:20px">
  <label>Match Winner</label><br>
  <input id="matchWinner" readonly>
</div>

<div style="text-align:center;margin-top:30px">
  <button id="submitMatch">Submit Match</button>
</div>

<script>
const rosters={
"Halfway Crooks":["Dan Foster","Tony Perelli","Don Young"],
"Haters Welcome":["Randy Rycraft","Joe Neal"],
"Killer Instinct":["Mike Uhlean","Doug Andrus"]
};

const playerData={
"Dan Foster":3,"Tony Perelli":5,"Don Young":4,
"Randy Rycraft":4,"Joe Neal":4,
"Mike Uhlean":5,"Doug Andrus":4
};

function renderRoster(team,el){
  el.innerHTML=(rosters[team]||[])
    .map(p=>`<div class="playerName" data-player="${p}">${p}</div>`)
    .join("");
}

team.onchange=()=>renderRoster(team.value,teamRoster);
opponent.onchange=()=>renderRoster(opponent.value,opponentRoster);

let lagFlip=false;

document.addEventListener("click",e=>{
  if(e.target.classList.contains("playerName")){
    const p=e.target.dataset.player;
    const hc=playerData[p]||0;
    if(!lagFlip){
      lagWinner.value=p;
      pA_hc.value=hc;
    }else{
      lagLoser.value=p;
      pB_hc.value=hc;
    }
    lagFlip=!lagFlip;
    updateMatchWinner();
  }
});

function updateMatchWinner(){
  const aWins=+pA_wins.value||0;
  const bWins=+pB_wins.value||0;
  const aHC=+pA_hc.value||0;
  const bHC=+pB_hc.value||0;
  matchWinner.value=
    (lagWinner.value && aWins>=aHC && aHC>0)?lagWinner.value:
    (lagLoser.value && bWins>=bHC && bHC>0)?lagLoser.value:"";
}

["pA_wins","pB_wins","pA_hc","pB_hc"].forEach(id=>{
  document.getElementById(id).addEventListener("input",updateMatchWinner);
});

submitMatch.onclick=()=>{
  const data={
    lagWinner:lagWinner.value,
    lagLoser:lagLoser.value,
    matchInnings:matchInnings.value,
    pA:{handicap:pA_hc.value,wins:pA_wins.value,losses:pA_losses.value,safeties:pA_safeties.value,e8:pA_e8.value,br:pA_br.value},
    pB:{handicap:pB_hc.value,wins:pB_wins.value,losses:pB_losses.value,safeties:pB_safeties.value,e8:pB_e8.value,br:pB_br.value},
    matchWinner:matchWinner.value
  };

  fetch("https://script.google.com/macros/s/AKfycbwdYBhFYGobu6Uvcx8vGM4vjigpDV-GPl25Hrg4un1xbxcx5x6YJOMB_oHwY9xuK_ei/exec",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  }).then(r=>r.text()).then(console.log);
};
</script>

</body>
</html>
